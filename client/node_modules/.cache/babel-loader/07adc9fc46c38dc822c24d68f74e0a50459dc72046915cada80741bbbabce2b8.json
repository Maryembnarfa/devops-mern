{"ast":null,"code":"import React from'react';import{Form,Input,Modal,Button,message}from\"antd\";import{useQuery,useMutation,useQueryClient}from\"@tanstack/react-query\";import{axiosInstance}from\"../../lib/axios\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function UpdateDelivery(_ref){let{openUpdate,setOpenUpdate,id}=_ref;const[form]=Form.useForm();const queryClient=useQueryClient();// Requête pour récupérer les données du produit\nconst{data,isLoading}=useQuery({queryKey:[\"delivry\",id],queryFn:async()=>{const response=await axiosInstance.get(`/delivry/${id}`);form.setFieldsValue(response.data);// Pré-remplir le formulaire\nreturn response.data;},enabled:!!id// N'exécute la requête que si un ID est défini\n});// Mutation pour mettre à jour les données\nconst mutation=useMutation({mutationFn:async values=>{return await axiosInstance.put(`/delivry/${id}`,values);},onSuccess:()=>{message.success(\"Livraison mis à jour avec succès !\");queryClient.invalidateQueries([\"delivry\"]);// Invalider le cache pour recharger les données\nsetOpenUpdate(false);// Fermer le modal\n},onError:()=>{message.error(\"Échec de la mise à jour du livraison !\");}});// Soumettre les données mises à jour\nconst handleUpdate=async()=>{try{const values=await form.validateFields();// Valider les champs du formulaire\nmutation.mutate(values);// Appeler la mutation\n}catch(error){console.log(\"Validation failed:\",error);}};return/*#__PURE__*/_jsx(Modal,{open:openUpdate,onCancel:()=>{setOpenUpdate(false);form.resetFields();// Réinitialiser le formulaire\n},onOk:()=>form.submit()// Soumettre le formulaire lors du clic sur OK\n,confirmLoading:isLoading||mutation.isLoading// Afficher un indicateur de chargement\n,children:/*#__PURE__*/_jsxs(Form,{form:form,name:\"update delivery\",onFinish:handleUpdate// Déclencher handleSubmit à la soumission\n,children:[/*#__PURE__*/_jsx(Form.Item,{label:\"Client\",name:\"client_name\",rules:[{required:true}],children:/*#__PURE__*/_jsx(Input,{})}),/*#__PURE__*/_jsx(Form.Item,{label:\"Adresse\",name:\"delivery_address\",rules:[{required:true}],children:/*#__PURE__*/_jsx(Input,{})}),/*#__PURE__*/_jsx(Form.Item,{label:\"Gouvernement\",name:\"government\",rules:[{required:true}],children:/*#__PURE__*/_jsx(Input,{})}),/*#__PURE__*/_jsx(Form.Item,{label:\"Phone\",name:\"phone1\",rules:[{required:true}],children:/*#__PURE__*/_jsx(Input,{})}),/*#__PURE__*/_jsx(Form.Item,{label:\"Strret\",name:\"street\",rules:[{required:true}],children:/*#__PURE__*/_jsx(Input,{})})]})});}","map":{"version":3,"names":["React","Form","Input","Modal","Button","message","useQuery","useMutation","useQueryClient","axiosInstance","jsx","_jsx","jsxs","_jsxs","UpdateDelivery","_ref","openUpdate","setOpenUpdate","id","form","useForm","queryClient","data","isLoading","queryKey","queryFn","response","get","setFieldsValue","enabled","mutation","mutationFn","values","put","onSuccess","success","invalidateQueries","onError","error","handleUpdate","validateFields","mutate","console","log","open","onCancel","resetFields","onOk","submit","confirmLoading","children","name","onFinish","Item","label","rules","required"],"sources":["C:/Users/Hp/Desktop/LIVRAISON/client/src/pages/dilevery/updateDelivery.jsx"],"sourcesContent":["import React from 'react';\r\nimport { Form, Input, Modal, Button, message } from \"antd\";\r\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport { axiosInstance } from \"../../lib/axios\";\r\n\r\nexport default function UpdateDelivery({ openUpdate, setOpenUpdate, id }) {\r\n    const [form] = Form.useForm();\r\n    const queryClient = useQueryClient();\r\n\r\n    // Requête pour récupérer les données du produit\r\n    const { data, isLoading } = useQuery({\r\n        queryKey: [\"delivry\", id],\r\n        queryFn: async () => {\r\n            const response = await axiosInstance.get(`/delivry/${id}`);\r\n            form.setFieldsValue(response.data); // Pré-remplir le formulaire\r\n            return response.data;\r\n        },\r\n        enabled: !!id, // N'exécute la requête que si un ID est défini\r\n    });\r\n\r\n    // Mutation pour mettre à jour les données\r\n    const mutation = useMutation({\r\n        mutationFn: async (values) => {\r\n            return await axiosInstance.put(`/delivry/${id}`, values);\r\n        },\r\n        onSuccess: () => {\r\n            message.success(\"Livraison mis à jour avec succès !\");\r\n            queryClient.invalidateQueries([\"delivry\"]); // Invalider le cache pour recharger les données\r\n            setOpenUpdate(false); // Fermer le modal\r\n        },\r\n        onError: () => {\r\n            message.error(\"Échec de la mise à jour du livraison !\");\r\n        },\r\n    });\r\n\r\n    // Soumettre les données mises à jour\r\n    const handleUpdate = async () => {\r\n        try {\r\n            const values = await form.validateFields(); // Valider les champs du formulaire\r\n            mutation.mutate(values); // Appeler la mutation\r\n        } catch (error) {\r\n            console.log(\"Validation failed:\", error);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Modal\r\n            open={openUpdate}\r\n            onCancel={() => {\r\n                setOpenUpdate(false);\r\n                form.resetFields(); // Réinitialiser le formulaire\r\n            }}\r\n            onOk={() => form.submit()} // Soumettre le formulaire lors du clic sur OK\r\n            confirmLoading={isLoading || mutation.isLoading} // Afficher un indicateur de chargement\r\n        >\r\n            <Form\r\n                form={form}\r\n                name=\"update delivery\"\r\n                onFinish={handleUpdate} // Déclencher handleSubmit à la soumission\r\n            >\r\n\r\n                <Form.Item label=\"Client\" name=\"client_name\" rules={[{ required: true }]}>\r\n                    <Input />\r\n                </Form.Item>\r\n                <Form.Item label=\"Adresse\" name=\"delivery_address\" rules={[{ required: true }]}>\r\n                    <Input />\r\n                </Form.Item>\r\n                <Form.Item label=\"Gouvernement\" name=\"government\" rules={[{ required: true }]}>\r\n                    <Input />\r\n                </Form.Item>\r\n                <Form.Item label=\"Phone\" name=\"phone1\" rules={[{ required: true }]}>\r\n                    <Input />\r\n                </Form.Item>\r\n                <Form.Item label=\"Strret\" name=\"street\" rules={[{ required: true }]}>\r\n                    <Input />\r\n                </Form.Item>\r\n\r\n\r\n\r\n\r\n            </Form>\r\n        </Modal>\r\n    );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}