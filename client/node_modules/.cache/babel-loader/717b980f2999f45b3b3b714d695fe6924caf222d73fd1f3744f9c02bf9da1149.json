{"ast":null,"code":"var __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport { path as d3path } from '@antv/vendor/d3-path';\nimport { applyStyle } from '../utils';\nimport { select } from '../../utils/selection';\nimport { isPolar } from '../../utils/coordinate';\nimport { angle, sub, dist } from '../../utils/vector';\nfunction getPath(p, coordinate) {\n  let size = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 4;\n  const path = d3path();\n  if (!isPolar(coordinate)) {\n    path.moveTo(...p[2]);\n    path.lineTo(...p[3]);\n    path.lineTo(p[3][0] - size, p[3][1]);\n    path.lineTo(p[10][0] - size, p[10][1]);\n    path.lineTo(p[10][0] + size, p[10][1]);\n    path.lineTo(p[3][0] + size, p[3][1]);\n    path.lineTo(...p[3]);\n    path.closePath();\n    path.moveTo(...p[10]);\n    path.lineTo(...p[11]);\n    path.moveTo(p[3][0] + size / 2, p[8][1]);\n    path.arc(p[3][0], p[8][1], size / 2, 0, Math.PI * 2);\n    path.closePath();\n    return path;\n  }\n  const center = coordinate.getCenter();\n  const [x, y] = center;\n  const radiusQ3 = dist(center, p[3]);\n  const radiusMedian = dist(center, p[8]);\n  const radiusQ1 = dist(center, p[10]);\n  const middleAngle = angle(sub(p[2], center));\n  const rectAngle = Math.asin(size / radiusMedian);\n  const startAngle = middleAngle - rectAngle;\n  const endAngle = middleAngle + rectAngle;\n  path.moveTo(...p[2]);\n  path.lineTo(...p[3]);\n  path.moveTo(Math.cos(startAngle) * radiusQ3 + x, Math.sin(startAngle) * radiusQ3 + y);\n  path.arc(x, y, radiusQ3, startAngle, endAngle);\n  path.lineTo(Math.cos(endAngle) * radiusQ1 + x, Math.sin(endAngle) * radiusQ1 + y);\n  path.arc(x, y, radiusQ1, endAngle, startAngle, true);\n  path.lineTo(Math.cos(startAngle) * radiusQ3 + x, Math.sin(startAngle) * radiusQ3 + y);\n  path.closePath();\n  path.moveTo(...p[10]);\n  path.lineTo(...p[11]);\n  const a = (startAngle + endAngle) / 2;\n  path.moveTo(Math.cos(a) * (radiusMedian + size / 2) + x, Math.sin(a) * (radiusMedian + size / 2) + y);\n  path.arc(Math.cos(a) * radiusMedian + x, Math.sin(a) * radiusMedian + y, size / 2, a, Math.PI * 2 + a);\n  path.closePath();\n  return path;\n}\nexport const Violin = (options, context) => {\n  const {\n    coordinate,\n    document\n  } = context;\n  return (points, value, defaults) => {\n    const {\n      color,\n      transform\n    } = value;\n    // TODO: how to setting it by size channel.\n    const size = 4;\n    const {\n        color: defaultColor,\n        fill = defaultColor,\n        stroke = defaultColor\n      } = defaults,\n      rest = __rest(defaults, [\"color\", \"fill\", \"stroke\"]);\n    const path = getPath(points, coordinate, size);\n    return select(document.createElement('path', {})).call(applyStyle, rest).style('d', path.toString()).style('stroke', stroke).style('fill', color || fill).style('transform', transform).call(applyStyle, options).node();\n  };\n};\nViolin.props = {\n  defaultMarker: 'point',\n  defaultEnterAnimation: 'fadeIn',\n  defaultUpdateAnimation: 'morphing',\n  defaultExitAnimation: 'fadeOut'\n};","map":{"version":3,"names":["path","d3path","applyStyle","select","isPolar","angle","sub","dist","getPath","p","coordinate","size","arguments","length","undefined","moveTo","lineTo","closePath","arc","Math","PI","center","getCenter","x","y","radiusQ3","radiusMedian","radiusQ1","middleAngle","rectAngle","asin","startAngle","endAngle","cos","sin","a","Violin","options","context","document","points","value","defaults","color","transform","defaultColor","fill","stroke","rest","__rest","createElement","call","style","toString","node","props","defaultMarker","defaultEnterAnimation","defaultUpdateAnimation","defaultExitAnimation"],"sources":["shape/box/violin.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}