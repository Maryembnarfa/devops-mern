{"ast":null,"code":"import { rollup } from '@antv/vendor/d3-array';\nfunction field(key) {\n  return typeof key === 'string' ? d => d[key] : key;\n}\n/**\n * Join data with another dataset by SQL style.\n */\nexport const Join = options => {\n  // const { fromKey, from, key, unknown = NaN, ...rest } = options;\n  const {\n    join,\n    on,\n    select = [],\n    as = select,\n    unknown = NaN\n  } = options;\n  const [key, fromKey] = on;\n  const fk = field(fromKey);\n  const k = field(key);\n  const keyData = rollup(join, _ref => {\n    let [d] = _ref;\n    return d;\n  },\n  // Get the first matched.\n  d => fk(d));\n  return data => data.map(d => {\n    const source = keyData.get(k(d));\n    return Object.assign(Object.assign({}, d), select.reduce((prev, key, idx) => (prev[as[idx]] = source ? source[key] : unknown, prev), {}));\n  });\n};\nJoin.props = {};","map":{"version":3,"names":["rollup","field","key","d","Join","options","join","on","select","as","unknown","NaN","fromKey","fk","k","keyData","_ref","data","map","source","get","Object","assign","reduce","prev","idx","props"],"sources":["data/join.ts"],"sourcesContent":[null],"mappings":"AAAA,SAASA,MAAM,QAAQ,uBAAuB;AAI9C,SAASC,KAAKA,CAACC,GAA+B;EAC5C,OAAO,OAAOA,GAAG,KAAK,QAAQ,GAAIC,CAAC,IAAKA,CAAC,CAACD,GAAG,CAAC,GAAGA,GAAG;AACtD;AAIA;;;AAGA,OAAO,MAAME,IAAI,GAAqBC,OAAO,IAAI;EAC/C;EACA,MAAM;IAAEC,IAAI;IAAEC,EAAE;IAAEC,MAAM,GAAG,EAAE;IAAEC,EAAE,GAAGD,MAAM;IAAEE,OAAO,GAAGC;EAAG,CAAE,GAAGN,OAAO;EACrE,MAAM,CAACH,GAAG,EAAEU,OAAO,CAAC,GAAGL,EAAE;EACzB,MAAMM,EAAE,GAAGZ,KAAK,CAACW,OAAO,CAAC;EACzB,MAAME,CAAC,GAAGb,KAAK,CAACC,GAAG,CAAC;EACpB,MAAMa,OAAO,GAAGf,MAAM,CACpBM,IAAI,EACJU,IAAA;IAAA,IAAC,CAACb,CAAC,CAAC,GAAAa,IAAA;IAAA,OAAKb,CAAC;EAAA;EAAE;EACXA,CAAC,IAAKU,EAAE,CAACV,CAAC,CAAC,CACb;EACD,OAAQc,IAAI,IACVA,IAAI,CAACC,GAAG,CAAEf,CAAC,IAAI;IACb,MAAMgB,MAAM,GAAGJ,OAAO,CAACK,GAAG,CAACN,CAAC,CAACX,CAAC,CAAC,CAAC;IAChC,OAAAkB,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA,KACKnB,CAAC,GACDK,MAAM,CAACe,MAAM,CACd,CAACC,IAAI,EAAEtB,GAAG,EAAEuB,GAAG,MACZD,IAAI,CAACf,EAAE,CAACgB,GAAG,CAAC,CAAC,GAAGN,MAAM,GAAGA,MAAM,CAACjB,GAAG,CAAC,GAAGQ,OAAO,EAAGc,IAAI,CACvD,EACD,EAAE,CACH;EAEL,CAAC,CAAC;AACN,CAAC;AAEDpB,IAAI,CAACsB,KAAK,GAAG,EAAE","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}