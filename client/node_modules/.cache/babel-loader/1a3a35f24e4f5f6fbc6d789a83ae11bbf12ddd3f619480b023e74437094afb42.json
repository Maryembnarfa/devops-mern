{"ast":null,"code":"import { Linear, createInterpolateValue } from '@antv/scale';\nimport { extent, max, rollups } from '@antv/vendor/d3-array';\nimport * as d3ScaleChromatic from '@antv/vendor/d3-scale-chromatic';\nimport { deepMix, omit, upperFirst } from '@antv/util';\nimport { firstOf, lastOf, unique } from '../utils/array';\nimport { defined, identity, isStrictObject } from '../utils/helper';\nimport { isTheta } from './coordinate';\nimport { useLibrary } from './library';\nexport function inferScale(name, values, options, coordinates, theme, library) {\n  const {\n    guide = {}\n  } = options;\n  const type = inferScaleType(name, values, options);\n  if (typeof type !== 'string') return options;\n  const expectedDomain = inferScaleDomain(type, name, values, options);\n  const actualDomain = maybeRatio(type, expectedDomain, options);\n  return Object.assign(Object.assign(Object.assign({}, options), inferScaleOptions(type, name, values, options, coordinates)), {\n    domain: actualDomain,\n    range: inferScaleRange(type, name, values, options, actualDomain, theme, library),\n    expectedDomain,\n    guide,\n    name,\n    type\n  });\n}\nexport function applyScale(channels, scale) {\n  const scaledValue = {};\n  for (const channel of channels) {\n    const {\n      values,\n      name: scaleName\n    } = channel;\n    const scaleInstance = scale[scaleName];\n    for (const value of values) {\n      const {\n        name,\n        value: V\n      } = value;\n      scaledValue[name] = V.map(d => scaleInstance.map(d));\n    }\n  }\n  return scaledValue;\n}\nexport function groupTransform(markState, uidScale) {\n  const channels = Array.from(markState.values()).flatMap(d => d.channels);\n  const scaleGroups = rollups(channels, channels => channels.map(d => uidScale.get(d.scale.uid)), d => d.name).filter(_ref => {\n    let [, scales] = _ref;\n    return scales.some(d => typeof d.getOptions().groupTransform === 'function') &&\n    // only sync scales with groupTransform options\n    scales.every(d => d.getTicks);\n  }).map(d => d[1]);\n  scaleGroups.forEach(group => {\n    const groupTransform = group.map(d => d.getOptions().groupTransform)[0];\n    groupTransform(group);\n  });\n}\nexport function collectScales(states, options) {\n  var _a;\n  const {\n    components = []\n  } = options;\n  const NONE_STATIC_KEYS = ['scale', 'encode', 'axis', 'legend', 'data', 'transform'];\n  // From normal marks.\n  const scales = Array.from(new Set(states.flatMap(d => d.channels.map(d => d.scale))));\n  // From static marks.\n  const nameScale = new Map(scales.map(scale => [scale.name, scale]));\n  for (const component of components) {\n    const channels = inferChannelsForComponent(component);\n    for (const channel of channels) {\n      const scale = nameScale.get(channel);\n      const staticScale = ((_a = component.scale) === null || _a === void 0 ? void 0 : _a[channel]) || {};\n      const {\n        independent = false\n      } = staticScale;\n      if (scale && !independent) {\n        // Merged with exist scales if is not independent.\n        const {\n          guide\n        } = scale;\n        const guide1 = typeof guide === 'boolean' ? {} : guide;\n        scale.guide = deepMix({}, guide1, component);\n        Object.assign(scale, staticScale);\n      } else {\n        // Append new scales without exit scales or independent.\n        const options1 = Object.assign(Object.assign({}, staticScale), {\n          expectedDomain: staticScale.domain,\n          name: channel,\n          guide: omit(component, NONE_STATIC_KEYS)\n        });\n        scales.push(options1);\n      }\n    }\n  }\n  return scales;\n}\nexport function useRelation(relations) {\n  if (!relations || !Array.isArray(relations)) return [identity, identity];\n  // Store original map and invert.\n  let map;\n  let invert;\n  const conditionalize = scale => {\n    var _a;\n    map = scale.map.bind(scale);\n    invert = (_a = scale.invert) === null || _a === void 0 ? void 0 : _a.bind(scale);\n    // Distinguish functions[function, output] and value[vale, output] relations.\n    const funcRelations = relations.filter(_ref2 => {\n      let [v] = _ref2;\n      return typeof v === 'function';\n    });\n    const valueRelations = relations.filter(_ref3 => {\n      let [v] = _ref3;\n      return typeof v !== 'function';\n    });\n    // Update scale.map\n    const valueOutput = new Map(valueRelations);\n    scale.map = x => {\n      for (const [verify, value] of funcRelations) {\n        if (verify(x)) return value;\n      }\n      if (valueOutput.has(x)) return valueOutput.get(x);\n      return map(x);\n    };\n    if (!invert) return scale;\n    // Update scale.invert\n    const outputValue = new Map(valueRelations.map(_ref4 => {\n      let [a, b] = _ref4;\n      return [b, a];\n    }));\n    const outputFunc = new Map(funcRelations.map(_ref5 => {\n      let [a, b] = _ref5;\n      return [b, a];\n    }));\n    scale.invert = x => {\n      if (outputFunc.has(x)) return x;\n      if (outputValue.has(x)) return outputValue.get(x);\n      return invert(x);\n    };\n    return scale;\n  };\n  const deconditionalize = scale => {\n    if (map !== null) scale.map = map;\n    if (invert !== null) scale.invert = invert;\n    return scale;\n  };\n  return [conditionalize, deconditionalize];\n}\nexport function assignScale(target, source) {\n  const keys = Object.keys(target);\n  for (const scale of Object.values(source)) {\n    const {\n      name\n    } = scale.getOptions();\n    if (!(name in target)) target[name] = scale;else {\n      const I = keys.filter(d => d.startsWith(name))\n      // Reg is for extract `1` from `x1`;\n      .map(d => +(d.replace(name, '') || 0));\n      const index = max(I) + 1;\n      const newKey = `${name}${index}`;\n      target[newKey] = scale;\n      scale.getOptions().key = newKey;\n    }\n  }\n  return target;\n}\nexport function useRelationScale(options, library) {\n  const [useScale] = useLibrary('scale', library);\n  const {\n    relations\n  } = options;\n  const [conditionalize] = useRelation(relations);\n  const scale = useScale(options);\n  return conditionalize(scale);\n}\nexport function syncFacetsScales(states) {\n  const scales = states.flatMap(d => Array.from(d.values())).flatMap(d => d.channels.map(d => d.scale));\n  syncFacetsScaleByChannel(scales, 'x');\n  syncFacetsScaleByChannel(scales, 'y');\n}\nfunction inferChannelsForComponent(component) {\n  const {\n    channels = [],\n    type,\n    scale = {}\n  } = component;\n  const L = ['shape', 'color', 'opacity', 'size'];\n  if (channels.length !== 0) return channels;\n  if (type === 'axisX') return ['x'];\n  if (type === 'axisY') return ['y'];\n  if (type === 'legends') return Object.keys(scale).filter(d => L.includes(d));\n  return [];\n}\nfunction syncFacetsScaleByChannel(scales, channel) {\n  const S = scales.filter(_ref6 => {\n    let {\n      name,\n      facet = true\n    } = _ref6;\n    return facet && name === channel;\n  });\n  const D = S.flatMap(d => d.domain);\n  const syncedD = S.every(isQuantitativeScale) ? extent(D) : S.every(isDiscreteScale) ? Array.from(new Set(D)) : null;\n  if (syncedD === null) return;\n  for (const scale of S) {\n    scale.domain = syncedD;\n  }\n}\nfunction maybeRatio(type, domain, options) {\n  const {\n    ratio\n  } = options;\n  if (ratio === undefined || ratio === null) return domain;\n  if (isQuantitativeScale({\n    type\n  })) {\n    return clampQuantitativeScale(domain, ratio, type);\n  }\n  if (isDiscreteScale({\n    type\n  })) return clampDiscreteScale(domain, ratio);\n  return domain;\n}\nfunction clampQuantitativeScale(domain, ratio, type) {\n  const D = domain.map(Number);\n  const scale = new Linear({\n    domain: D,\n    range: [D[0], D[0] + (D[D.length - 1] - D[0]) * ratio]\n  });\n  if (type === 'time') return domain.map(d => new Date(scale.map(d)));\n  return domain.map(d => scale.map(d));\n}\nfunction clampDiscreteScale(domain, ratio) {\n  const index = Math.round(domain.length * ratio);\n  return domain.slice(0, index);\n}\nfunction isQuantitativeScale(scale) {\n  const {\n    type\n  } = scale;\n  if (typeof type !== 'string') return false;\n  // Do not take quantize, quantile or threshold scale into account,\n  // because they are not for position scales. If they are, there is\n  // no need to sync them.\n  const names = ['linear', 'log', 'pow', 'time'];\n  return names.includes(type);\n}\nfunction isDiscreteScale(scale) {\n  const {\n    type\n  } = scale;\n  if (typeof type !== 'string') return false;\n  const names = ['band', 'point', 'ordinal'];\n  return names.includes(type);\n}\n// @todo More accurate inference for different cases.\nfunction inferScaleType(name, values, options) {\n  const {\n    type,\n    domain,\n    range,\n    quantitative,\n    ordinal\n  } = options;\n  if (type !== undefined) return type;\n  if (isObject(values)) return 'identity';\n  if (typeof range === 'string') return 'linear';\n  if ((domain || range || []).length > 2) return asOrdinalType(name, ordinal);\n  if (domain !== undefined) {\n    if (isOrdinal([domain])) return asOrdinalType(name, ordinal);\n    if (isTemporal(values)) return 'time';\n    return asQuantitativeType(name, range, quantitative);\n  }\n  if (isOrdinal(values)) return asOrdinalType(name, ordinal);\n  if (isTemporal(values)) return 'time';\n  return asQuantitativeType(name, range, quantitative);\n}\nfunction inferScaleDomain(type, name, values, options) {\n  const {\n    domain\n  } = options;\n  if (domain !== undefined) return domain;\n  switch (type) {\n    case 'linear':\n    case 'time':\n    case 'log':\n    case 'pow':\n    case 'sqrt':\n    case 'quantize':\n    case 'threshold':\n      return maybeMinMax(inferDomainQ(values, options), options);\n    case 'band':\n    case 'ordinal':\n    case 'point':\n      return inferDomainC(values);\n    case 'quantile':\n      return inferDomainO(values);\n    case 'sequential':\n      return maybeMinMax(inferDomainS(values), options);\n    default:\n      return [];\n  }\n}\nfunction inferScaleRange(type, name, values, options, domain, theme, library) {\n  const {\n    range\n  } = options;\n  if (typeof range === 'string') return gradientColors(range);\n  if (range !== undefined) return range;\n  const {\n    rangeMin,\n    rangeMax\n  } = options;\n  switch (type) {\n    case 'linear':\n    case 'time':\n    case 'log':\n    case 'pow':\n    case 'sqrt':\n      {\n        const colors = categoricalColors(values, options, domain, theme, library);\n        const [r0, r1] = inferRangeQ(name, colors);\n        return [rangeMin !== null && rangeMin !== void 0 ? rangeMin : r0, rangeMax !== null && rangeMax !== void 0 ? rangeMax : r1];\n      }\n    case 'band':\n    case 'point':\n      {\n        const min = name === 'size' ? 5 : 0;\n        const max = name === 'size' ? 10 : 1;\n        return [rangeMin !== null && rangeMin !== void 0 ? rangeMin : min, rangeMax !== null && rangeMax !== void 0 ? rangeMax : max];\n      }\n    case 'ordinal':\n      {\n        return categoricalColors(values, options, domain, theme, library);\n      }\n    case 'sequential':\n      return undefined;\n    case 'constant':\n      return [values[0][0]];\n    default:\n      return [];\n  }\n}\nfunction inferScaleOptions(type, name, values, options, coordinates) {\n  switch (type) {\n    case 'linear':\n    case 'time':\n    case 'log':\n    case 'pow':\n    case 'sqrt':\n      return inferOptionsQ(coordinates, options);\n    case 'band':\n    case 'point':\n      return inferOptionsC(type, name, coordinates, options);\n    case 'sequential':\n      return inferOptionsS(options);\n    default:\n      return options;\n  }\n}\nfunction categoricalColors(values, options, domain, theme, library) {\n  const [usePalette] = useLibrary('palette', library);\n  const {\n    category10: c10,\n    category20: c20\n  } = theme;\n  const defaultPalette = unique(domain).length <= c10.length ? c10 : c20;\n  const {\n    palette = defaultPalette,\n    offset\n  } = options;\n  if (Array.isArray(palette)) return palette;\n  // Built-in palettes have higher priority.\n  try {\n    return usePalette({\n      type: palette\n    });\n  } catch (e) {\n    const colors = interpolatedColors(palette, domain, offset);\n    if (colors) return colors;\n    throw new Error(`Unknown Component: ${palette} `);\n  }\n}\nfunction gradientColors(range) {\n  return range.split('-');\n}\nfunction interpolatedColors(palette, domain) {\n  let offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : d => d;\n  if (!palette) return null;\n  const fullName = upperFirst(palette);\n  // If scheme have enough colors, then return pre-defined colors.\n  const scheme = d3ScaleChromatic[`scheme${fullName}`];\n  const interpolator = d3ScaleChromatic[`interpolate${fullName}`];\n  if (!scheme && !interpolator) return null;\n  if (scheme) {\n    // If is a one dimension array, return it.\n    if (!scheme.some(Array.isArray)) return scheme;\n    const schemeColors = scheme[domain.length];\n    if (schemeColors) return schemeColors;\n  }\n  // Otherwise interpolate to get full colors.\n  return domain.map((_, i) => interpolator(offset(i / domain.length)));\n}\nfunction inferOptionsS(options) {\n  const {\n    palette = 'ylGnBu',\n    offset\n  } = options;\n  const name = upperFirst(palette);\n  const interpolator = d3ScaleChromatic[`interpolate${name}`];\n  if (!interpolator) throw new Error(`Unknown palette: ${name}`);\n  return {\n    interpolator: offset ? x => interpolator(offset(x)) : interpolator\n  };\n}\nfunction inferOptionsQ(coordinates, options) {\n  const {\n    interpolate = createInterpolateValue,\n    nice = false,\n    tickCount = 5\n  } = options;\n  return Object.assign(Object.assign({}, options), {\n    interpolate,\n    nice,\n    tickCount\n  });\n}\nfunction inferOptionsC(type, name, coordinates, options) {\n  if (options.padding !== undefined || options.paddingInner !== undefined || options.paddingOuter !== undefined) {\n    return Object.assign(Object.assign({}, options), {\n      unknown: NaN\n    });\n  }\n  const padding = inferPadding(type, name, coordinates);\n  const {\n    paddingInner = padding,\n    paddingOuter = padding\n  } = options;\n  return Object.assign(Object.assign({}, options), {\n    paddingInner,\n    paddingOuter,\n    padding,\n    unknown: NaN\n  });\n}\nfunction inferPadding(type, name, coordinates) {\n  // The scale for enterDelay and enterDuration should has zero padding by default.\n  // Because there is no need to add extra delay for the start and the end.\n  if (name === 'enterDelay' || name === 'enterDuration') return 0;\n  if (name === 'size') return 0;\n  if (type === 'band') return isTheta(coordinates) ? 0 : 0.1;\n  // Point scale need 0.5 padding to make interval between first and last point\n  // equal to other intervals in polar coordinate.\n  if (type === 'point') return 0.5;\n  return 0;\n}\nfunction asOrdinalType(name, defaults) {\n  if (defaults) return defaults;\n  return isQuantitative(name) ? 'point' : 'ordinal';\n}\nfunction asQuantitativeType(name, range, defaults) {\n  if (defaults) return defaults;\n  if (name !== 'color') return 'linear';\n  return range ? 'linear' : 'sequential';\n}\nfunction maybeMinMax(domain, options) {\n  if (domain.length === 0) return domain;\n  const {\n    domainMin,\n    domainMax\n  } = options;\n  const [d0, d1] = domain;\n  return [domainMin !== null && domainMin !== void 0 ? domainMin : d0, domainMax !== null && domainMax !== void 0 ? domainMax : d1];\n}\nfunction inferDomainQ(values, options) {\n  const {\n    zero = false\n  } = options;\n  let min = Infinity;\n  let max = -Infinity;\n  for (const value of values) {\n    for (const d of value) {\n      if (defined(d)) {\n        min = Math.min(min, +d);\n        max = Math.max(max, +d);\n      }\n    }\n  }\n  if (min === Infinity) return [];\n  return zero ? [Math.min(0, min), max] : [min, max];\n}\nfunction inferDomainC(values) {\n  return Array.from(new Set(values.flat()));\n}\nfunction inferDomainO(values) {\n  return values.flat().sort();\n}\nfunction inferDomainS(values) {\n  let min = Infinity;\n  let max = -Infinity;\n  for (const value of values) {\n    for (const d of value) {\n      if (defined(d)) {\n        min = Math.min(min, +d);\n        max = Math.max(max, +d);\n      }\n    }\n  }\n  if (min === Infinity) return [];\n  return [min < 0 ? -max : min, max];\n}\n/**\n * @todo More nice default range for enterDelay and enterDuration.\n * @todo Move these to channel definition.\n */\nfunction inferRangeQ(name, palette) {\n  if (name === 'enterDelay') return [0, 1000];\n  if (name == 'enterDuration') return [300, 1000];\n  if (name.startsWith('y') || name.startsWith('position')) return [1, 0];\n  if (name === 'color') return [firstOf(palette), lastOf(palette)];\n  if (name === 'opacity') return [0, 1];\n  if (name === 'size') return [1, 10];\n  return [0, 1];\n}\nfunction isOrdinal(values) {\n  return some(values, d => {\n    const type = typeof d;\n    return type === 'string' || type === 'boolean';\n  });\n}\nfunction isTemporal(values) {\n  return some(values, d => d instanceof Date);\n}\nfunction isObject(values) {\n  return some(values, isStrictObject);\n}\nfunction some(values, callback) {\n  for (const V of values) {\n    if (V.some(callback)) return true;\n  }\n  return false;\n}\nfunction isQuantitative(name) {\n  return name.startsWith('x') || name.startsWith('y') || name.startsWith('position') || name.startsWith('size');\n}\n// Spatial and temporal position.\nexport function isPosition(name) {\n  return name.startsWith('x') || name.startsWith('y') || name.startsWith('position') || name === 'enterDelay' || name === 'enterDuration' || name === 'updateDelay' || name === 'updateDuration' || name === 'exitDelay' || name === 'exitDuration';\n}\nexport function isValidScale(scale) {\n  if (!scale || !scale.type) return false;\n  if (typeof scale.type === 'function') return true;\n  const {\n    type,\n    domain,\n    range,\n    interpolator\n  } = scale;\n  const isValidDomain = domain && domain.length > 0;\n  const isValidRange = range && range.length > 0;\n  if (['linear', 'sqrt', 'log', 'time', 'pow', 'threshold', 'quantize', 'quantile', 'ordinal', 'band', 'point'].includes(type) && isValidDomain && isValidRange) {\n    return true;\n  }\n  if (['sequential'].includes(type) && isValidDomain && (isValidRange || interpolator)) {\n    return true;\n  }\n  if (['constant', 'identity'].includes(type) && isValidRange) return true;\n  return false;\n}","map":{"version":3,"names":["Linear","createInterpolateValue","extent","max","rollups","d3ScaleChromatic","deepMix","omit","upperFirst","firstOf","lastOf","unique","defined","identity","isStrictObject","isTheta","useLibrary","inferScale","name","values","options","coordinates","theme","library","guide","type","inferScaleType","expectedDomain","inferScaleDomain","actualDomain","maybeRatio","Object","assign","inferScaleOptions","domain","range","inferScaleRange","applyScale","channels","scale","scaledValue","channel","scaleName","scaleInstance","value","V","map","d","groupTransform","markState","uidScale","Array","from","flatMap","scaleGroups","get","uid","filter","_ref","scales","some","getOptions","every","getTicks","forEach","group","collectScales","states","components","NONE_STATIC_KEYS","Set","nameScale","Map","component","inferChannelsForComponent","staticScale","_a","independent","guide1","options1","push","useRelation","relations","isArray","invert","conditionalize","bind","funcRelations","_ref2","v","valueRelations","_ref3","valueOutput","x","verify","has","outputValue","_ref4","a","b","outputFunc","_ref5","deconditionalize","assignScale","target","source","keys","I","startsWith","replace","index","newKey","key","useRelationScale","useScale","syncFacetsScales","syncFacetsScaleByChannel","L","length","includes","S","_ref6","facet","D","syncedD","isQuantitativeScale","isDiscreteScale","ratio","undefined","clampQuantitativeScale","clampDiscreteScale","Number","Date","Math","round","slice","names","quantitative","ordinal","isObject","asOrdinalType","isOrdinal","isTemporal","asQuantitativeType","maybeMinMax","inferDomainQ","inferDomainC","inferDomainO","inferDomainS","gradientColors","rangeMin","rangeMax","colors","categoricalColors","r0","r1","inferRangeQ","min","inferOptionsQ","inferOptionsC","inferOptionsS","usePalette","category10","c10","category20","c20","defaultPalette","palette","offset","e","interpolatedColors","Error","split","arguments","fullName","scheme","interpolator","schemeColors","_","i","interpolate","nice","tickCount","padding","paddingInner","paddingOuter","unknown","NaN","inferPadding","defaults","isQuantitative","domainMin","domainMax","d0","d1","zero","Infinity","flat","sort","callback","isPosition","isValidScale","isValidDomain","isValidRange"],"sources":["runtime/scale.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}