{"ast":null,"code":"import { deepMix } from '@antv/util';\nimport { isUnset } from '../utils/helper';\nimport { dynamicFormatDateTime } from '../utils/dateFormat';\nimport { columnOf } from './utils/helper';\n/**\n * Infer title channel from x-position channel.\n */\nexport const MaybeTitle = function () {\n  let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  const {\n    channel = 'x'\n  } = options;\n  return (I, mark) => {\n    const {\n      encode\n    } = mark;\n    const {\n      tooltip\n    } = mark;\n    if (isUnset(tooltip)) return [I, mark];\n    const {\n      title\n    } = tooltip;\n    if (title !== undefined) return [I, mark];\n    const titles = Object.keys(encode).filter(key => key.startsWith(channel)).filter(key => !encode[key].inferred).map(key => columnOf(encode, key)).filter(_ref => {\n      let [T] = _ref;\n      return T;\n    }).map(d => d[0]);\n    if (titles.length === 0) return [I, mark];\n    const T = [];\n    for (const i of I) {\n      T[i] = {\n        value: titles.map(t => t[i] instanceof Date ? dynamicFormatDateTime(t[i]) : t[i]).join(', ')\n      };\n    }\n    return [I, deepMix({}, mark, {\n      tooltip: {\n        title: T\n      }\n    })];\n  };\n};\nMaybeTitle.props = {};","map":{"version":3,"names":["deepMix","isUnset","dynamicFormatDateTime","columnOf","MaybeTitle","options","arguments","length","undefined","channel","I","mark","encode","tooltip","title","titles","Object","keys","filter","key","startsWith","inferred","map","_ref","T","d","i","value","t","Date","join","props"],"sources":["transform/maybeTitle.ts"],"sourcesContent":[null],"mappings":"AAAA,SAASA,OAAO,QAAQ,YAAY;AACpC,SAASC,OAAO,QAAQ,iBAAiB;AAEzC,SAASC,qBAAqB,QAAQ,qBAAqB;AAC3D,SAASC,QAAQ,QAAQ,gBAAgB;AAMzC;;;AAGA,OAAO,MAAMC,UAAU,GAA0B,SAAAA,CAAA,EAAiB;EAAA,IAAhBC,OAAO,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,EAAE;EAC5D,MAAM;IAAEG,OAAO,GAAG;EAAG,CAAE,GAAGJ,OAAO;EACjC,OAAO,CAACK,CAAC,EAAEC,IAAI,KAAI;IACjB,MAAM;MAAEC;IAAM,CAAE,GAAGD,IAAI;IACvB,MAAM;MAAEE;IAAO,CAAE,GAAGF,IAAI;IACxB,IAAIV,OAAO,CAACY,OAAO,CAAC,EAAE,OAAO,CAACH,CAAC,EAAEC,IAAI,CAAC;IACtC,MAAM;MAAEG;IAAK,CAAE,GAAGD,OAAO;IACzB,IAAIC,KAAK,KAAKN,SAAS,EAAE,OAAO,CAACE,CAAC,EAAEC,IAAI,CAAC;IACzC,MAAMI,MAAM,GAAGC,MAAM,CAACC,IAAI,CAACL,MAAM,CAAC,CAC/BM,MAAM,CAAEC,GAAG,IAAKA,GAAG,CAACC,UAAU,CAACX,OAAO,CAAC,CAAC,CACxCS,MAAM,CAAEC,GAAG,IAAK,CAACP,MAAM,CAACO,GAAG,CAAC,CAACE,QAAQ,CAAC,CACtCC,GAAG,CAAEH,GAAG,IAAKhB,QAAQ,CAACS,MAAM,EAAEO,GAAG,CAAC,CAAC,CACnCD,MAAM,CAACK,IAAA;MAAA,IAAC,CAACC,CAAC,CAAC,GAAAD,IAAA;MAAA,OAAKC,CAAC;IAAA,EAAC,CAClBF,GAAG,CAAEG,CAAC,IAAKA,CAAC,CAAC,CAAC,CAAC,CAAC;IACnB,IAAIV,MAAM,CAACR,MAAM,KAAK,CAAC,EAAE,OAAO,CAACG,CAAC,EAAEC,IAAI,CAAC;IACzC,MAAMa,CAAC,GAAG,EAAE;IACZ,KAAK,MAAME,CAAC,IAAIhB,CAAC,EAAE;MACjBc,CAAC,CAACE,CAAC,CAAC,GAAG;QACLC,KAAK,EAAEZ,MAAM,CACVO,GAAG,CAAEM,CAAC,IACLA,CAAC,CAACF,CAAC,CAAC,YAAYG,IAAI,GAAG3B,qBAAqB,CAAC0B,CAAC,CAACF,CAAC,CAAS,CAAC,GAAGE,CAAC,CAACF,CAAC,CAAC,CAClE,CACAI,IAAI,CAAC,IAAI;OACb;;IAEH,OAAO,CACLpB,CAAC,EACDV,OAAO,CAAC,EAAE,EAAEW,IAAI,EAAE;MAChBE,OAAO,EAAE;QACPC,KAAK,EAAEU;;KAEV,CAAC,CACH;EACH,CAAC;AACH,CAAC;AAEDpB,UAAU,CAAC2B,KAAK,GAAG,EAAE","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}