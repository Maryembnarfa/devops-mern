{"ast":null,"code":"/**\n * BFS nodes and execute callback.\n */\nfunction bfs(node, callback) {\n  const discovered = [node];\n  while (discovered.length) {\n    const currentNode = discovered.shift();\n    callback && callback(currentNode);\n    const children = currentNode.children || [];\n    for (const child of children) {\n      discovered.push(child);\n    }\n  }\n}\n/**\n * Hierarchy container.\n */\nexport class Node {\n  constructor() {\n    let value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let type = arguments.length > 1 ? arguments[1] : undefined;\n    // The parent node.\n    this.parentNode = null;\n    // The children nodes.\n    this.children = [];\n    // The index of parent children.\n    this.index = 0;\n    this.type = type;\n    this.value = value;\n  }\n  /**\n   * Apply specified transform to current value. Mount the node\n   * to replace the original one in the tree and then return it.\n   */\n  map() {\n    let transform = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : x => x;\n    const newValue = transform(this.value);\n    this.value = newValue;\n    return this;\n  }\n  /**\n   * Set or get the specified attribute. It the value is specified, update\n   * the attribute of current value and return the node. Otherwise\n   * return the the attribute of current value.\n   */\n  attr(key, value) {\n    if (arguments.length === 1) return this.value[key];\n    return this.map(v => (v[key] = value, v));\n  }\n  /**\n   * Create a new node and append to children nodes.\n   */\n  append(Ctor) {\n    const node = new Ctor({});\n    node.children = [];\n    this.push(node);\n    return node;\n  }\n  push(node) {\n    node.parentNode = this;\n    node.index = this.children.length;\n    this.children.push(node);\n    return this;\n  }\n  /**\n   * Remove current node from parentNode.\n   */\n  remove() {\n    const parent = this.parentNode;\n    if (parent) {\n      const {\n        children\n      } = parent;\n      const index = children.findIndex(item => item === this);\n      children.splice(index, 1);\n    }\n    return this;\n  }\n  getNodeByKey(key) {\n    let targetNode = null;\n    const callback = node => {\n      if (key === node.attr('key')) {\n        targetNode = node;\n      }\n    };\n    bfs(this, callback);\n    return targetNode;\n  }\n  getNodesByType(type) {\n    const nodes = [];\n    const callback = node => {\n      if (type === node.type) {\n        nodes.push(node);\n      }\n    };\n    bfs(this, callback);\n    return nodes;\n  }\n  getNodeByType(type) {\n    let node = null;\n    bfs(this, current => {\n      if (node) return;\n      if (type === current.type) node = current;\n    });\n    return node;\n  }\n  /**\n   * Apply specified callback to the node value.\n   */\n  call(callback) {\n    for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      params[_key - 1] = arguments[_key];\n    }\n    callback(this.map(), ...params);\n    return this;\n  }\n  getRoot() {\n    // Find the root chart and render.\n    let root = this;\n    while (root && root.parentNode) {\n      root = root.parentNode;\n    }\n    return root;\n  }\n}","map":{"version":3,"names":["bfs","node","callback","discovered","length","currentNode","shift","children","child","push","Node","constructor","value","arguments","undefined","type","parentNode","index","map","transform","x","newValue","attr","key","v","append","Ctor","remove","parent","findIndex","item","splice","getNodeByKey","targetNode","getNodesByType","nodes","getNodeByType","current","call","_len","params","Array","_key","getRoot","root"],"sources":["api/node.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}