{"ast":null,"code":"import React from'react';import{useQuery}from'@tanstack/react-query';import{Pie}from'@ant-design/plots';import{axiosInstance}from'../lib/axios';// Fonction pour récupérer les livraisons\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const fetchDeliveries=async()=>{const response=await axiosInstance.get('/delivry');return response.data;};// Fonction pour formater les données pour le graphique\nconst formatDataForPieChart=deliveries=>{if(!deliveries)return[];const statusCounts={enattente:0,endepot:0,encours:0,retoure:0,retourd:0,livré:0};deliveries.forEach(delivery=>{if(delivery.status==='EnAttente')statusCounts.enattente++;else if(delivery.status==='EnDepot')statusCounts.endepot++;else if(delivery.status==='EnCours')statusCounts.encours++;else if(delivery.status==='RetourE')statusCounts.retoure++;else if(delivery.status==='RetourD')statusCounts.retourd++;else if(delivery.status==='Livré')statusCounts.livré++;});return[{type:'EnAttente',value:statusCounts.enattente},{type:'EnDepot',value:statusCounts.endepot},// Correction d'affichage\n{type:'EnCours',value:statusCounts.encours},{type:'RetourE',value:statusCounts.retoure},{type:'RetourD',value:statusCounts.retourd},{type:'Livré',value:statusCounts.livré}];};const DeliveryPieChart=()=>{// Utilisation correcte de useQuery (React Query v5)\nconst{data:deliveries,isLoading,isError}=useQuery({queryKey:['deliveries'],queryFn:fetchDeliveries});if(isLoading)return/*#__PURE__*/_jsx(\"div\",{children:\"Chargement des donn\\xE9es...\"});if(isError)return/*#__PURE__*/_jsx(\"div\",{children:\"Erreur lors de la r\\xE9cup\\xE9ration des donn\\xE9es\"});// Formater les données pour le graphique\nconst chartData=formatDataForPieChart(deliveries);// Configuration du graphique\nconst config={data:chartData,angleField:'value',colorField:'type',radius:0.6,label:{text:d=>`${d.type}\\n ${d.value}`,position:'spider'},legend:{color:{title:false,position:'right',rowPadding:5}}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{style:{textAlign:'center',fontSize:18,fontWeight:500},children:\"Statistiques des livraisons\"}),/*#__PURE__*/_jsx(Pie,{...config})]});};export default DeliveryPieChart;","map":{"version":3,"names":["React","useQuery","Pie","axiosInstance","jsx","_jsx","jsxs","_jsxs","fetchDeliveries","response","get","data","formatDataForPieChart","deliveries","statusCounts","enattente","endepot","encours","retoure","retourd","livré","forEach","delivery","status","type","value","DeliveryPieChart","isLoading","isError","queryKey","queryFn","children","chartData","config","angleField","colorField","radius","label","text","d","position","legend","color","title","rowPadding","style","textAlign","fontSize","fontWeight"],"sources":["C:/Users/Hp/Desktop/LIVRAISON/client/src/pages/charts.jsx"],"sourcesContent":["import React from 'react';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { Pie } from '@ant-design/plots';\r\nimport { axiosInstance } from '../lib/axios';\r\n\r\n// Fonction pour récupérer les livraisons\r\nconst fetchDeliveries = async () => {\r\n    const response = await axiosInstance.get('/delivry');\r\n    return response.data;\r\n};\r\n\r\n// Fonction pour formater les données pour le graphique\r\nconst formatDataForPieChart = (deliveries) => {\r\n    if (!deliveries) return [];\r\n\r\n    const statusCounts = {\r\n        enattente: 0,\r\n        endepot: 0,\r\n        encours: 0,\r\n        retoure: 0,\r\n        retourd: 0,\r\n        livré: 0,\r\n    };\r\n\r\n    deliveries.forEach((delivery) => {\r\n        if (delivery.status === 'EnAttente') statusCounts.enattente++;\r\n        else if (delivery.status === 'EnDepot') statusCounts.endepot++;\r\n        else if (delivery.status === 'EnCours') statusCounts.encours++;\r\n        else if (delivery.status === 'RetourE') statusCounts.retoure++;\r\n        else if (delivery.status === 'RetourD') statusCounts.retourd++;\r\n        else if (delivery.status === 'Livré') statusCounts.livré++;\r\n\r\n\r\n    });\r\n\r\n    return [\r\n        { type: 'EnAttente', value: statusCounts.enattente },\r\n        { type: 'EnDepot', value: statusCounts.endepot }, // Correction d'affichage\r\n        { type: 'EnCours', value: statusCounts.encours },\r\n        { type: 'RetourE', value: statusCounts.retoure },\r\n\r\n        { type: 'RetourD', value: statusCounts.retourd },\r\n\r\n        { type: 'Livré', value: statusCounts.livré },\r\n\r\n    ];\r\n};\r\n\r\nconst DeliveryPieChart = () => {\r\n    // Utilisation correcte de useQuery (React Query v5)\r\n    const { data: deliveries, isLoading, isError } = useQuery({\r\n        queryKey: ['deliveries'],\r\n        queryFn: fetchDeliveries,\r\n    });\r\n\r\n    if (isLoading) return <div>Chargement des données...</div>;\r\n    if (isError) return <div>Erreur lors de la récupération des données</div>;\r\n\r\n    // Formater les données pour le graphique\r\n    const chartData = formatDataForPieChart(deliveries);\r\n\r\n    // Configuration du graphique\r\n    const config = {\r\n        data: chartData,\r\n        angleField: 'value',\r\n        colorField: 'type',\r\n        radius: 0.6,\r\n        label: {\r\n            text: (d) => `${d.type}\\n ${d.value}`,\r\n            position: 'spider',\r\n        },\r\n        legend: {\r\n            color: {\r\n                title: false,\r\n                position: 'right',\r\n                rowPadding: 5,\r\n            },\r\n        },\r\n\r\n    };\r\n    return (\r\n        <div>\r\n            <h2 style={{ textAlign: 'center', fontSize: 18, fontWeight: 500 }}>\r\n                Statistiques des livraisons\r\n            </h2>\r\n            <Pie {...config} />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default DeliveryPieChart;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}