{"ast":null,"code":"var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nimport { deepMix, throttle } from '@antv/util';\nimport { subObject } from '../utils/helper';\nimport { useState, setCursor, restoreCursor } from './utils';\nexport const CATEGORY_LEGEND_CLASS_NAME = 'legend-category';\nexport const CONTINUOUS_LEGEND_CLASS_NAME = 'legend-continuous';\nexport const LEGEND_ITEMS_CLASS_NAME = 'items-item';\nexport const LEGEND_MAKER_CLASS_NAME = 'legend-category-item-marker';\nexport const LEGEND_LABEL_CLASS_NAME = 'legend-category-item-label';\nexport function markerOf(item) {\n  return item.getElementsByClassName(LEGEND_MAKER_CLASS_NAME)[0];\n}\nexport function labelOf(item) {\n  return item.getElementsByClassName(LEGEND_LABEL_CLASS_NAME)[0];\n}\nexport function itemsOf(root) {\n  return root.getElementsByClassName(LEGEND_ITEMS_CLASS_NAME);\n}\nexport function legendsOf(root) {\n  return root.getElementsByClassName(CATEGORY_LEGEND_CLASS_NAME);\n}\nexport function legendsContinuousOf(root) {\n  return root.getElementsByClassName(CONTINUOUS_LEGEND_CLASS_NAME);\n}\nexport function legendClearSetState(root, setState) {\n  const legends = [...legendsOf(root), ...legendsContinuousOf(root)];\n  legends.forEach(legend => {\n    setState(legend, v => v);\n  });\n}\nexport function dataOf(root) {\n  // legend -> layout -> container\n  let parent = root.parentNode;\n  while (parent && !parent.__data__) {\n    parent = parent.parentNode;\n  }\n  return parent.__data__;\n}\nexport function attributesOf(root) {\n  let child = root;\n  while (child && !child.attr('class').startsWith('legend')) {\n    child = child.children[0];\n  }\n  return child.attributes;\n}\nfunction legendFilterOrdinal(root, _ref) {\n  let {\n    legends,\n    // given the root of chart returns legends to be manipulated\n    marker: markerOf,\n    // given the legend returns the marker\n    label: labelOf,\n    // given the legend returns the label\n    datum,\n    // given the legend returns the value\n    filter,\n    // invoke when dispatch filter event,\n    emitter,\n    channel,\n    state = {} // state options\n  } = _ref;\n  // Index handler by item.\n  const itemClick = new Map();\n  const itemPointerenter = new Map();\n  const itemPointerout = new Map();\n  const {\n    unselected = {\n      markerStroke: '#aaa',\n      markerFill: '#aaa',\n      labelFill: '#aaa'\n    }\n  } = state;\n  const markerStyle = {\n    unselected: subObject(unselected, 'marker')\n  };\n  const labelStyle = {\n    unselected: subObject(unselected, 'label')\n  };\n  const {\n    setState: setM,\n    removeState: removeM\n  } = useState(markerStyle, undefined);\n  const {\n    setState: setL,\n    removeState: removeL\n  } = useState(labelStyle, undefined);\n  const items = Array.from(legends(root));\n  let selectedValues = items.map(datum);\n  const updateLegendState = () => {\n    for (const item of items) {\n      const value = datum(item);\n      const marker = markerOf(item);\n      const label = labelOf(item);\n      if (!selectedValues.includes(value)) {\n        setM(marker, 'unselected');\n        setL(label, 'unselected');\n      } else {\n        removeM(marker, 'unselected');\n        removeL(label, 'unselected');\n      }\n    }\n  };\n  for (const item of items) {\n    // Defined handlers.\n    const pointerenter = () => {\n      setCursor(root, 'pointer');\n    };\n    const pointerout = () => {\n      restoreCursor(root);\n    };\n    const click = event => __awaiter(this, void 0, void 0, function* () {\n      const value = datum(item);\n      const index = selectedValues.indexOf(value);\n      if (index === -1) selectedValues.push(value);else selectedValues.splice(index, 1);\n      yield filter(selectedValues);\n      updateLegendState();\n      const {\n        nativeEvent = true\n      } = event;\n      if (!nativeEvent) return;\n      if (selectedValues.length === items.length) {\n        emitter.emit('legend:reset', {\n          nativeEvent\n        });\n      } else {\n        // Emit events.\n        emitter.emit('legend:filter', Object.assign(Object.assign({}, event), {\n          nativeEvent,\n          data: {\n            channel,\n            values: selectedValues\n          }\n        }));\n      }\n    });\n    // Bind and store handlers.\n    item.addEventListener('click', click);\n    item.addEventListener('pointerenter', pointerenter);\n    item.addEventListener('pointerout', pointerout);\n    itemClick.set(item, click);\n    itemPointerenter.set(item, pointerenter);\n    itemPointerout.set(item, pointerout);\n  }\n  const onFilter = event => __awaiter(this, void 0, void 0, function* () {\n    const {\n      nativeEvent\n    } = event;\n    if (nativeEvent) return;\n    const {\n      data\n    } = event;\n    const {\n      channel: specifiedChannel,\n      values\n    } = data;\n    if (specifiedChannel !== channel) return;\n    selectedValues = values;\n    yield filter(selectedValues);\n    updateLegendState();\n  });\n  const onEnd = event => __awaiter(this, void 0, void 0, function* () {\n    const {\n      nativeEvent\n    } = event;\n    if (nativeEvent) return;\n    selectedValues = items.map(datum);\n    yield filter(selectedValues);\n    updateLegendState();\n  });\n  emitter.on('legend:filter', onFilter);\n  emitter.on('legend:reset', onEnd);\n  return () => {\n    for (const item of items) {\n      item.removeEventListener('click', itemClick.get(item));\n      item.removeEventListener('pointerenter', itemPointerenter.get(item));\n      item.removeEventListener('pointerout', itemPointerout.get(item));\n      emitter.off('legend:filter', onFilter);\n      emitter.off('legend:reset', onEnd);\n    }\n  };\n}\nfunction legendFilterContinuous(_, _ref2) {\n  let {\n    legend,\n    filter,\n    emitter,\n    channel\n  } = _ref2;\n  const onValueChange = _ref3 => {\n    let {\n      detail: {\n        value\n      }\n    } = _ref3;\n    filter(value);\n    emitter.emit({\n      nativeEvent: true,\n      data: {\n        channel,\n        values: value\n      }\n    });\n  };\n  legend.addEventListener('valuechange', onValueChange);\n  return () => {\n    legend.removeEventListener('valuechange', onValueChange);\n  };\n}\nfunction filterView(context, // View instance,\n_ref4) {\n  let {\n    legend,\n    // Legend instance.\n    channel,\n    // Filter Channel.\n    value,\n    // Filtered Values.\n    ordinal,\n    // Data type of the legend.\n    channels,\n    // Channels for this legend.\n    allChannels,\n    // Channels for all legends.\n    facet = false // For facet.\n  } = _ref4;\n  return __awaiter(this, void 0, void 0, function* () {\n    const {\n      view,\n      update,\n      setState\n    } = context;\n    setState(legend, viewOptions => {\n      const {\n        marks\n      } = viewOptions;\n      // Add filter transform for every marks,\n      // which will skip for mark without color channel.\n      const newMarks = marks.map(mark => {\n        if (mark.type === 'legends') return mark;\n        // Inset after aggregate transform, such as group, and bin.\n        const {\n          transform = [],\n          data = []\n        } = mark;\n        const index = transform.findIndex(_ref5 => {\n          let {\n            type\n          } = _ref5;\n          return type.startsWith('group') || type.startsWith('bin');\n        });\n        const newTransform = [...transform];\n        if (data.length) {\n          newTransform.splice(index + 1, 0, {\n            type: 'filter',\n            [channel]: {\n              value,\n              ordinal\n            }\n          });\n        }\n        // Set domain of scale to preserve encoding.\n        const newScale = Object.fromEntries(channels.map(channel => [channel, {\n          domain: view.scale[channel].getOptions().domain\n        }]));\n        return deepMix({}, mark, Object.assign(Object.assign({\n          transform: newTransform,\n          scale: newScale\n        }, !ordinal && {\n          animate: false\n        }), {\n          legend: facet ? false : Object.fromEntries(allChannels.map(d => [d, {\n            preserve: true\n          }]))\n        }));\n      });\n      return Object.assign(Object.assign({}, viewOptions), {\n        marks: newMarks\n      });\n    });\n    yield update();\n  });\n}\nfunction filterFacets(facets, options) {\n  for (const facet of facets) {\n    filterView(facet, Object.assign(Object.assign({}, options), {\n      facet: true\n    }));\n  }\n}\nexport function LegendFilter() {\n  return (context, contexts, emitter) => {\n    const {\n      container\n    } = context;\n    const facets = contexts.filter(d => d !== context);\n    const isFacet = facets.length > 0;\n    const channelsOf = legend => {\n      return dataOf(legend).scales.map(d => d.name);\n    };\n    const legends = [...legendsOf(container), ...legendsContinuousOf(container)];\n    const allChannels = legends.flatMap(channelsOf);\n    const filter = isFacet ? throttle(filterFacets, 50, {\n      trailing: true\n    }) : throttle(filterView, 50, {\n      trailing: true\n    });\n    const removes = legends.map(legend => {\n      const {\n        name: channel,\n        domain\n      } = dataOf(legend).scales[0];\n      const channels = channelsOf(legend);\n      const common = {\n        legend,\n        channel,\n        channels,\n        allChannels\n      };\n      if (legend.className === CATEGORY_LEGEND_CLASS_NAME) {\n        return legendFilterOrdinal(container, {\n          legends: itemsOf,\n          marker: markerOf,\n          label: labelOf,\n          datum: d => {\n            const {\n              __data__: datum\n            } = d;\n            const {\n              index\n            } = datum;\n            return domain[index];\n          },\n          filter: value => {\n            const options = Object.assign(Object.assign({}, common), {\n              value,\n              ordinal: true\n            });\n            if (isFacet) filter(facets, options);else filter(context, options);\n          },\n          state: legend.attributes.state,\n          channel,\n          emitter\n        });\n      } else {\n        return legendFilterContinuous(container, {\n          legend,\n          filter: value => {\n            const options = Object.assign(Object.assign({}, common), {\n              value,\n              ordinal: false\n            });\n            if (isFacet) filter(facets, options);else filter(context, options);\n          },\n          emitter,\n          channel\n        });\n      }\n    });\n    return () => {\n      removes.forEach(remove => remove());\n    };\n  };\n}","map":{"version":3,"names":["deepMix","throttle","subObject","useState","setCursor","restoreCursor","CATEGORY_LEGEND_CLASS_NAME","CONTINUOUS_LEGEND_CLASS_NAME","LEGEND_ITEMS_CLASS_NAME","LEGEND_MAKER_CLASS_NAME","LEGEND_LABEL_CLASS_NAME","markerOf","item","getElementsByClassName","labelOf","itemsOf","root","legendsOf","legendsContinuousOf","legendClearSetState","setState","legends","forEach","legend","v","dataOf","parent","parentNode","__data__","attributesOf","child","attr","startsWith","children","attributes","legendFilterOrdinal","_ref","marker","label","datum","filter","emitter","channel","state","itemClick","Map","itemPointerenter","itemPointerout","unselected","markerStroke","markerFill","labelFill","markerStyle","labelStyle","setM","removeState","removeM","undefined","setL","removeL","items","Array","from","selectedValues","map","updateLegendState","value","includes","pointerenter","pointerout","click","event","__awaiter","index","indexOf","push","splice","nativeEvent","length","emit","Object","assign","data","values","addEventListener","set","onFilter","specifiedChannel","onEnd","on","removeEventListener","get","off","legendFilterContinuous","_","_ref2","onValueChange","_ref3","detail","filterView","context","_ref4","ordinal","channels","allChannels","facet","view","update","viewOptions","marks","newMarks","mark","type","transform","findIndex","_ref5","newTransform","newScale","fromEntries","domain","scale","getOptions","animate","d","preserve","filterFacets","facets","options","LegendFilter","contexts","container","isFacet","channelsOf","scales","name","flatMap","trailing","removes","common","className","remove"],"sources":["interaction/legendFilter.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}